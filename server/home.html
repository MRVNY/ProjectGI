<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>ProjectGI</title>
    <link rel="stylesheet" href="home.css" />
</head>

<body onload="generateID()">
    <h1>Welcome to the ProjectGI experiment !</h1>

    <form method="GET" action="experiment" id="to_send">
        <ul>
            <li> Hello, thank you for participating in our experiment on keyboard and gestural interactions. <br><br> We estimate that the complete test will need about 5 minutes to finish. Please make sure you are in a conformable and concentrated state in order to provide the most accurate results of yourself.</li>
            <br>
            <li>You are assigned to: <strong id="id"></strong>, your test will be: <strong id="type"></strong>, if you prefer another test, please refresh the page.
            </li>
            <input name="user_id", id="user_id" hidden=true>
            <input name="experiment_type", id="experiment_type" hidden=true>
            <script>
                async function generateID(){
                    description = {
                        0 : "1 keyboard shortcut with 1-4 keys",
                        1 : "2 keyboard shortcuts with 1-4 keys",
                        2 : "1 gesture shortcut of 1 direction",
                        3 : "2 gesture shortcuts of 1 direction",
                        4 : "1 gesture shortcut of 2 directions" 
                    }
                    types = {
                        0 : "ONEKEY",
                        1 : "TWOKEY",
                        2 : "ONEDIR",
                        3 : "TWODIR",
                        4 : "TWODIRONEDRAW" 
                    }
                    user_id = document.getElementById("user_id");
                    experiment_type = document.getElementById("experiment_type");
                    id = document.getElementById("id");
                    type  = document.getElementById("type");
                    
                    const tmp = await fetch('./logs/availability.txt');
                    const availability = await tmp.text();

                    experiment_type.value = Math.floor(Math.random() * 5);
                    user_id.value = Math.floor(Math.random() * 20);

                    while(await fetch('./logs/' + type[experiment_type.value] + user_id.value + '.csv').ok){
                        experiment_type.value = Math.floor(Math.random() * 5);
                        user_id.value = Math.floor(Math.random() * 20);
                    }

                    id.innerHTML = "Participant " + user_id.value;
                    type.innerHTML = description[experiment_type.value];
                    
}                   
            </script>
            <li>
                <p>Please select your keyboard type :</p>
                <table>
                    <thead>
                        <th>AZERTY</th>
                        <th>QWERTY</th>
                    </thead>
                    <tbody>
                        <td><label for="input_azerty"><img alt="AZERTY keyboard image" src="res/azerty-keyboard.jpg" /></label</td>
                        <td><label for="input_qwerty"><img alt="QWERTY keyboard image" src="res/qwerty-keyboard.jpg" /></label>
                        </td>
                    </tbody>
                    <tfoot>
                        <td><input type="radio" name="keyboard_layout" value="AZERTY" id="input_azerty" required /></td>
                        <td><input type="radio" name="keyboard_layout" value="QWERTY" id="input_qwerty" required /></td>
                    </tfoot>
                </table>
            </li>
            <li>
                <p>Please select your mouse type :</p>
                <table>
                    <thead>
                        <th>Laptop touchpad </th>
                        <th>Desktop mouse</th>
                    </thead>
                    <tbody>
                        <td><label for="input_touchpad"><img alt="Touchpad image" src="res/touchpad.jpg" /></label></td>
                        <td><label for="input_classic_mouse"><img alt="Classic mouse image" src="res/classic-mouse.jpg" /></label></td>
                    </tbody>
                    <tfoot>
                        <td><input type="radio" name="mouse_type" value="touchpad" id="input_touchpad" required /></td>
                        <td><input type="radio" name="mouse_type" value="classic_mouse" id="input_classic_mouse" required /></td>
                    </tfoot>
                </table>
            </li>
            <li>By clicking on "I accept", you consent to sharing your performance data on our experiment as well as your personal data with us. All data will not be used for anything other than research purposes :</li>
        </ul>
        <button type="submit">I accept</button>
    </form>
</body>

</html>